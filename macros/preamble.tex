%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Preamble file is used to define pdf parameters, to include required packages

\usepackage{ifpdf}

\input{settings.tex} %Various settings
\input{macros/layout.tex}

\ifpdf
    \usepackage[pdftex]{hyperref,graphicx} % pdf references support

    \hypersetup{%
    	pdfauthor   = {\thesisAuthorName \ \thesisAuthorSurname},
    	pdftitle    = {\thesisTitleEN},
    	pdfsubject  = {PhD Thesis},
    	pdfkeywords = {\thesisTitleLT},
    	pdfcreator  = {LaTeX with hyperref package},
    	pdfproducer = {pdflatex},
    	breaklinks  = {true},
    	pdfstartview = {FitH},
    	bookmarksnumbered = {true},
    	bookmarksopen = {true},	
    	bookmarksopenlevel = 2,
    	plainpages={false},
    	pdfpagetransition={Dissolve},	
    	colorlinks = {true}, %defaultinis, padaro spalvotus stačiakampius ant visų linkų. Uždėjus true, bus tik spalvos ant skaicių. Turbut gražiau atrodo tik spalvos.
    	% Norint nespalvotu nuorodu į formules, literatura, etc, nustatome šias spalvas
    	linkcolor = {black}, %Vidinių nuorodų spalava
    	citecolor = {black}, %Citavimų spalva
    	filecolor = {black}, 
        urlcolor  = {black}, % Spalva išorinių nuorodų
    	% pilkos atspalviai:
    	% linkcolor = [rgb]{0.3, 0.3, 0.3},
    	%citecolor = [rgb]{0.6, 0.6, 0.6},
    	%filecolor = [rgb]{0.3, 0.3, 0.3},
    	%runcolor = [rgb]{0.3, 0.3, 0.3},
    }
\else
    \usepackage[dvips,ps2pdf]{hyperref,graphicx} % pdf references support
\fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Packages that are used in the document

\usepackage[immediate]{silence} % Package to silence some warnings
\WarningFilter[temp]{latex}{Command \underbar has changed.} % Silence sectsty package the warning
\WarningFilter[temp]{latex}{Command \underline has changed.} % Silence sectsty package the warning

%------ įkėliau iš preambule į santrauka
%\usepackage[L7x]{fontenc}
%\usepackage[utf8]{inputenc} % Accept different input encodings
\usepackage[T1]{fontenc} %Font encoding. The T1 font encoding is an 8-bit encoding and uses fonts that have 256 glyphs. 

\usepackage{times} %It does set \rmdefault to Times, \sfdefault to Helvetica, and \ttdefault to Courier

\usepackage{aeguill} %The package enables the user to add guillemets from several source (Polish cmr, Cyrillic cmr, lasy and ec) to the ae fonts.

\usepackage[lithuanian, english]{babel} %This package manages culturally-determined typographical (and other) rules for a wide range of languages.
\newcommand{\english}{\selectlanguage{english}}
\newcommand{\lithuanian}{\selectlanguage{lithuanian}}

\usepackage{amssymb}					% Extra AMS math symbols
\usepackage{amsfonts}					% Extra AMS math symbols
\usepackage{amsmath}					% AMS 
\usepackage[mathscr]{euscript}          % This file sets up some font shape definitions to use the Euler script symbols in math mode. 

\usepackage[table,dvipsnames]{xcolor}	% Colors support
\renewcommand{\topfraction}{0.85}	    %% 85% of page can contain figure
\renewcommand{\textfraction}{0.1}	    %% 10% of page can contain text
\renewcommand{\floatpagefraction}{0.75}	%% 75% of page should be figure to be only float page

\usepackage[square,comma,numbers,sort&compress]{natbib}	% Citations define numberic type citation, e.g, [1]
\setlength{\bibsep}{0ex}

\usepackage{fancyhdr}		    % Fancy headings and footers
\usepackage{sectsty}			% Change sections fonts, raises two warnings			

\setcounter{secnumdepth}{3}	    % Depth of enumerated sections

\ifpdf
	\usepackage{microtype}		% Experimental https://texdoc.org/serve/microtype/0
\else
\fi

\usepackage{makeidx}			% index package
\makeindex
% \usepackage{fix2col}			% fix two-column marks since 2015 not update use multicolumn instead. TODO delete
\input{macros/index.tex}	    % macros for dictionary like index			

\usepackage{palatino}			% IZ selection, font package

\usepackage{verbatim}           %IZ: multiline komentams 

\usepackage{paralist}           % Provides enumerate and itemize environments that can be used within paragraphs. https://ctan.org/pkg/paralist
\usepackage{tabularx}           % More advanced tables
\usepackage{longtable}          % For long tables used in acronyms, notations, vocabulary
\usepackage{booktabs}           % The package enhances the quality of tables. https://ctan.org/pkg/booktabs
\usepackage{multirow}           % Create tabular cells spanning multiple rows. https://ctan.org/pkg/multirow
\setlength{\belowcaptionskip}{5pt}

\usepackage{rotating}	        % Rotation tools, including rotated full-page floats https://ctan.org/pkg/rotating

\usepackage{epigraph}	        % A package for typesetting epigraphs. Epigraphs are the pithy quotations often found at the start (or end) of a chapter. https://ctan.org/pkg/epigraph

\usepackage{hyphenat}           %Disable/enable hypenation (žodžių perkėlimui įnaują       eilutę). By default is enabled in babel package. Used in title
 
\usepackage{pdfpages}           % Prikabina išorinius pdf failus prie latex pdf failo

\usepackage{array}              % Extending the array and tabular environments. https://ctan.org/pkg/array

\usepackage{float}              % Improved interface for floating objects. https://ctan.org/pkg/float

\usepackage{siunitx}   %paketas skaiciams ir SI vienetams vaizduoti. Galima ir nenaudoti, bet aukstesnis lygis, naudojamo pavyzdys \qty{67890}{\degree}
%\usepackage{textcomp}  %senas paketas, bet reikalingas kad nemestu kai kuriu siunitx klaidu
%\sisetup{load-configurations = abbreviations}

\setlength{\headheight}{19pt}  % Kažkokia problema su headheight

% Reikia sablonui. Gal galima ištrinti?
\usepackage[version=4]{mhchem} % Typeset chemical formulae/equations https://ctan.org/pkg/mhchem
\DeclareSIUnit \uM{\micro M}
\DeclareSIUnit \mM{\milli M}

\usepackage{tocloft}           % Control table of contents, figures, etc https://www.ctan.org/pkg/tocloft

\usepackage{titlesec}          % Select alternative section titles https://ctan.org/pkg/titlesec. Used for correct spacing and alignment of various titles

\usepackage{hologo}            % A collection of logos with bookmark support. https://ctan.org/pkg/hologo
\usepackage{cleveref}          % Intelligent cross-referencing. https://ctan.org/pkg/cleveref
\usepackage{tikz}              % Used to create figures

\usepackage{caption}           % Caption and subcaption packages allow to create subfigures and subtables
\usepackage{subcaption}        % see https://www.overleaf.com/learn/latex/How_to_Write_a_Thesis_in_LaTeX_(Part_3)%3A_Figures%2C_Subfigures_and_Tables#Subfigures

\WarningFilter{glossaries}{No language module} % - Removes warning starting with "No language module" from "glossaries"
\usepackage[toc, nonumberlist,noredefwarn,acronym=true,savewrites]{glossaries} % Makes various glossaries

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Various document formatting redefinitions

% Set fonts according to the style / Nustatomi fontai pagal skyrių reikalavimus
\chapterfont{\fontsize{12}{13.5}\selectfont\normalfont\centering\MakeUppercase}
\sectionfont{\fontsize{12}{13.5}\selectfont\normalfont\centering}
\subsectionfont{\fontsize{11}{12}\selectfont\normalfont\centering}
\subsubsectionfont{\fontsize{11}{12}\selectfont\normalfont\centering}
\titlespacing*{\chapter} {0pt}{0pt}{13.5pt} %commaand from the titlesec package
\titlespacing*{\section} {0pt}{13.5pt}{13.5pt}
\titlespacing*{\subsection} {0pt}{13.5pt}{13.5pt}
\titlespacing*{\subsubsection} {0pt}{13.5pt}{13.5pt}

\titlelabel{\thetitle.\quad} %Add dot after chapter, section numbers
% The unnumbered definition follows
\titleformat{name=\chapter}[display]
    {\normalfont}{}{-14mm}{\thechapter. \quad\centering\normalfont\MakeUppercase}
\titleformat{name=\chapter,numberless}[display]
    {\normalfont}{}{-14mm}{\centering\normalfont\MakeUppercase}

%% TOC (Table of Contents) formatting
\tocloftpagestyle{plain}
\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}} % for chapters adds dots in table of contents
\renewcommand{\cftchapfont}{\normalfont} %Change chapter font to normal in table of contents
\renewcommand{\cftchappagefont}{\normalfont} %Change chapter page number font to normal in table of contents

%Rename default Contents table name and change font size
\renewcommand{\cfttoctitlefont}{\fontsize{12}{13.5}\selectfont\normalfont\hfill}
\renewcommand{\cftlottitlefont}{\fontsize{12}{13.5}\selectfont\normalfont\hfill} %List of Tables
\renewcommand{\cftloftitlefont}{\fontsize{12}{13.5}\selectfont\normalfont\hfill} %List of Figures
%For centering title
\renewcommand{\cftaftertoctitle}{\hfill\ } 
\renewcommand{\cftafterlottitle}{\hfill\ } 
\renewcommand{\cftafterloftitle}{\hfill\ } 

%Formating TOC lists
\addto\captionsenglish{
    \renewcommand{\contentsname}{\MakeUppercase{\tableOfContentsName}}
    \renewcommand{\listtablename}{\MakeUppercase{\listOfTableName}}
    \renewcommand{\listfigurename}{\MakeUppercase{\listOfFiguresName}}
}
\addto\captionslithuanian{
    \renewcommand{\contentsname}{\MakeUppercase{\tableOfContentsName}}
    \renewcommand{\listtablename}{\MakeUppercase{\listOfTableName}}
    \renewcommand{\listfigurename}{\MakeUppercase{\listOfFiguresName}}
}

% Spacing after TOC titles
\setlength{\cftaftertoctitleskip}{13.5pt}
\setlength{\cftafterlottitleskip}{13.5pt}
\setlength{\cftafterloftitleskip}{13.5pt}

% Make correct spacing for all titles in TOC
\setlength{\cftbeforechapskip}{0pt}
\setlength{\cftbeforesecskip}{0pt}
\setlength{\cftbeforesubsecskip}{0pt}
\setlength{\cftbeforesubsubsecskip}{0pt}
\setlength{\cftbeforeparaskip}{0pt}
\setlength{\cftparskip}{5pt}

% Add dot after chapter, section, subsection number to fit dissetation format
\renewcommand{\cftchapaftersnum}{.}
\renewcommand{\cftsecaftersnum}{.}
\renewcommand{\cftsubsecaftersnum}{.}

%Create glossary for symbols
% \newglossary[〈glossary-label〉-glg]{〈glossary-label〉}{〈glossary-label〉-
% gls}{〈glossary-label〉-glo}{〈title〉}[〈counter〉]
\newglossary[symbols-glg]{symbols}{symbols-gls}{symbols-glo}{Symbols - Žymėjimai}
\makeglossaries                                                      % Inicialize gloassaries


% Changing acronyms and abreviation style
\newglossarystyle{abbr-style}{%
    \setglossarystyle{long}% Default style
    % Put the glossary in a longtable environment:
    \renewenvironment{theglossary}%
        {\begin{longtable}[l]{p{3cm}p{8cm}}} %Total available width is 11cm
        {\end{longtable}}%   
    % Set the table’s header: title row
    \renewcommand*{\glossaryheader}{%
        \bfseries Term & \bfseries Description
        \\\endhead}%
    % No table header:
    \renewcommand*{\glossaryheader}{}%
    \renewcommand*{\glossentry}[2]{%
        \glsentryitem{##1}%
        \glstarget{##1}{\textit{\glossentryname{##1}}} &     %Change of name to italic
        \glossentrydesc{##1}\glspostdescription\space ##2 \\
    }
    % Nothing between groups: (group is term with same starting letter)
    \renewcommand*{\glsgroupskip}{}%
}


\newglossarystyle{nounits}{%
    \setglossarystyle{long3colheader}%
    % put the glossary in a longtable environment:
    \renewenvironment{theglossary}%
     {\addcontentsline{toc}{chapter}{\thetitle}
     \begin{longtable}[l]{p{1in}p{3in}l}}
     %{\begin{longtable}{lp{\glsdescwidth}l}}%
     {\end{longtable}}%
    % Set the table’s header: title row
    \renewcommand*{\glossaryheader}{%
     \bfseries Term & \bfseries Description
     \\\endhead}%
    % No table header:
    %\renewcommand*{\glossaryheader}{}%
    % No heading between groups:
     \renewcommand*{\glsgroupheading}[1]{}%
    % Main (level 0) entries displayed in a row optionally numbered:
     \renewcommand*{\glossaryentryfield}[5]{%
        \glstarget{##1}{##2}% Name
        & ##3% Description
        \\% end of row
     }%
    % Similarly for sub-entries (no sub-entry numbers):
    \renewcommand*{\glossarysubentryfield}[6]{%
        % ignoring first argument (sub-level)
        \glstarget{##2}{##3}% Name
        & ##4% Description
        \\% end of row
     }%
    % Nothing between groups:
    %\renewcommand*{\glsgroupskip}{}%
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Additional macros

\input{macros/iz_macros.tex}
% \input{macros/index.tex} %yra viršuje

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Useful commands

% \k{I} - uždeda nosines raides
% Unit conversion - https://tex.stackexchange.com/questions/8260/what-are-the-various-units-ex-em-in-pt-bp-dd-pc-expressed-in-mm